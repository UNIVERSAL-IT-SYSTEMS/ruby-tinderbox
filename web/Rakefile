require_relative 'app'

task default: 'unit:test'

namespace :unit do
	task :test do
		Dir.glob('./test/test_*.rb') { |f| require f }
	end
end

namespace :db do
	DB.loggers << Logger.new($stdout)

	task :migrate do
		Sequel.extension :migration
		Sequel::Migrator.run(DB, 'db/migrations')
	end

	task :update_packages do
		update_packages
	end

	task :update_ci do
		update_ci
	end
end

namespace :aws do
	task :run_ci_full do
		run_ci(0)
	end

	task :run_ci_limited do
		run_ci(5)
	end
end
