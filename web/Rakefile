require_relative 'app'
DB.loggers << Logger.new($stdout)

namespace :db do

	task :migrate do
		Sequel.extension :migration
		Sequel::Migrator.run(DB, 'db/migrations')
	end

	task :package_clear do
		packages = DB[:packages]
		packages.delete
	end

	task :ci_clear do
		builds = DB[:builds]
		builds.delete
	end

	task package_update: [:package_clear] do
		package_update
	end

	task :ci_update do
		ci_update
	end

end

namespace :aws do

	task :ci_full_run do
		ci_run(0)
	end

	task :ci_limited_run do
		ci_run(5)
	end

end
